SELECT * FROM EMPLOYEE;
SELECT * FROM DEPARTMENT;
SELECT * FROM JOB_HISTORIES;
SELECT * FROM JOBES;
SELECT * FROM LOCATIONES;
SELECT * FROM COUNTRIES;
SELECT * FROM REGIONS;


SELECT D.DEPARTMENT_NAME, J.START_DATE AS FIRST_HIRE, J.END_DATE AS LAST_HIRE FROM DEPARTMENT D JOIN
JOB_HISTORIES J ON D.DEPARTMENT_ID = J.DEPARTMENT_ID ORDER BY FIRST_HIRE;

SELECT D.DEPARTMENT_NAME, M.FIRST_NAME, M.LAST_NAME, COUNT(E.EMPLOYEE_ID) AS EMPLOYEE_COUNT, AVG(E.SALARY) AS AVG_SALARY FROM EMPLOYEE E
JOIN DEPARTMENTS D ON E.DEPARTMENT_ID = D.DEPARTMENT_ID
JOIN EMPLOYEE M ON E.MANAGER_ID = M.EMPLOYEE_ID
WHERE E.MANAGER_ID = D.MANAGER_ID
GROUP BY D.DEPARTMENT_NAME, M.FIRST_NAME, M.LAST_NAME;

SELECT E.FIRST_NAME, E.LAST_NAME, M.FIRST_NAME AS MANAGER_FIRST_NAME, M.LAST_NAME AS MANAGER_LAST_NAME FROM EMPLOYEE E JOIN
EMPLOYEE M ON E.MANAGER_ID = M.EMPLOYEE_ID;

SELECT L.CITY, D.DEPARTMENT_NAME, COUNT(E.EMPLOYEE_ID) FROM DEPARTMENT D JOIN EMPLOYEE E ON E.DEPARTMENT_ID = D.DEPARTMENT_ID
JOIN LOCATIONES L ON L.LOCATION_ID = D.LOCATION_ID GROUP BY D.DEPARTMENT_NAME, L.CITY;

SELECT FIRST_NAME, LAST_NAME, SALARY, HIRE_DATE, DEPARTMENT_NAME FROM EMPLOYEE
WHERE SALARY > (SELECT AVG(E2.SALARY) FROM EMPLOYEE E2 WHERE E2.DEPARTMENT_ID = EMPLOYEE.DEPARTMENT_ID);

SELECT FIRST_NAME, LAST_NAME, SALARY, HIRE_DATE, (SELECT DEPARTMENT_NAME FROM DEPARTMENTS D WHERE D.DEPARTMENT_ID = E.DEPARTMENT_ID) AS DEPARTMENT_NAME
FROM EMPLOYEE E WHERE SALARY > (SELECT AVG(SALARY)FROM EMPLOYEE WHERE DEPARTMENT_ID = E.DEPARTMENT_ID);

SELECT E.FIRST_NAME ||' '|| E.LAST_NAME AS FULL_NAME , M.FIRST_NAME ||' '|| M.LAST_NAME AS MANAGER_FULL_NAME FROM EMPLOYEE E JOIN
EMPLOYEE M ON E.MANAGER_ID = M.EMPLOYEE_ID;

SELECT D.DEPARTMENT_NAME, SUM(E.SALARY) AS TOTAL_SALARY FROM EMPLOYEE E JOIN DEPARTMENT D ON E.DEPARTMENT_ID = D.DEPARTMENT_ID
GROUP BY D.DEPARTMENT_NAME HAVING SUM(E.salary) > SUM(E.SALARY)*0.1;

SELECT D.DEPARTMENT_NAME, COUNT(E.EMPLOYEE_ID) FROM EMPLOYEE E JOIN DEPARTMENT D ON E.DEPARTMENT_ID = D.DEPARTMENT_ID 
GROUP BY D.DEPARTMENT_NAME HAVING COUNT(E.EMPLOYEE_ID)> (SELECT AVG(EMP_COUNT) FROM 
(SELECT COUNT(EMPLOYEE_ID) AS EMP_COUNT FROM EMPLOYEE GROUP BY DEPARTMENT_ID));

SELECT E.FIRST_NAME, E.LAST_NAME, D.DEPARTMENT_NAME,(SELECT SUM(E1.SALARY) FROM EMPLOYEE E1 WHERE E1.DEPARTMENT_ID = E.DEPARTMENT_ID) AS TOTAL_SALARY 
FROM EMPLOYEE E JOIN DEPARTMENT D ON E.DEPARTMENT_ID = D.DEPARTMENT_ID 
WHERE D.DEPARTMENT_NAME = 'Sales' 
  AND E.FIRST_NAME LIKE 'E%'
ORDER BY E.LAST_NAME ASC;

-- Tumhari first cloumn main manager ki jagga employees ke naam print ho rhe hain aur dosre main managers ke naam print ho rhe
-- kiya kia jaye itna toh data bhi nahi hai
-- Where ki condition ki jaga uper naam change krdo 
--Purani wali query likho